<!DOCTYPE html>
<html>
<head>
    <title>Chat App</title>

<style>
:root {
    --vh: 1vh;
}

body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;  /* Prevent page scrolling when keyboard is open */
}

#chat-window {
    height: calc(90 * var(--vh));  /* Use the vh variable to set the height */
    overflow-y: scroll;
}

#chat-input {
    height: calc(10 * var(--vh));
    width: 100%;
}
</style>

</head>
<body>
    <div id="chat-window">
        <!-- Chat messages will be appended here -->
    </div>
    <textarea id="chat-input" placeholder="Type a message..."></textarea>
    <button id="send-button">Send</button>

<script>
document.addEventListener('DOMContentLoaded', (event) => {
    // Set the vh variable in CSS
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);

    // Update the vh variable when the window is resized
    window.addEventListener('resize', () => {
        let vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
        setTimeout(() => {
            document.getElementById('chat-window').scrollTop = document.getElementById('chat-window').scrollHeight;
        }, 100);
    });

    // Focus the text area
    setTimeout(() => {
        document.getElementById('chat-input').focus();
    }, 100);
});

function recieveMessage(msg) {
  var chatWindow = document.getElementById('chat-window');
  var newMessage = document.createElement('p');
  newMessage.textContent = msg;
  chatWindow.appendChild(newMessage);

  // scroll to bottom
  setTimeout(() => {
    chatWindow.scrollTop = chatWindow.scrollHeight;
  }, 100);
}

setInterval(() => {
  // Send a fake message
  let rand = Math.random() * 100;
  rand = Math.floor(rand);
  recieveMessage('Hello, world! ' + rand);
}, 1000);

function sendMessage() {
    var chatInput = document.getElementById('chat-input');
    recieveMessage(chatInput.value);
    chatInput.value = '';
}

document.getElementById('send-button').addEventListener('click', sendMessage);

document.getElementById('chat-input').addEventListener('keydown', (event) => {
    if (event.key === 'Enter') {
      sendMessage();
      event.preventDefault();
    }
});

</script>

</body>
</html>
